<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.mapper.AndMemberMapper">

	<select id="login" resultType="kr.co.model.MemberVO">
		SELECT * FROM MEMBER WHERE EMAIL = #{email}
	</select>
	<select id="idcheck" resultType="String">
		SELECT COUNT(*) FROM MEMBER WHERE EMAIL = #{email}
	</select>
	<insert id="join" >
		INSERT INTO MEMBER (EMAIL, GUARDIAN_ID, PW, NAME, PHONE, BIRTH, GENDER, BLOOD,  ADDRESS, ADDRESS_DETAIL, SOCIAL, TOKEN)
		VALUES (#{email}, #{guardian_id}, #{pw}, #{name}, #{phone}, #{birth}, #{gender}, #{blood}, #{address}, #{address_detail},#{social}, #{TOKEN})
	</insert>

	<select id="findid" resultType="String">
		SELECT EMAIL FROM MEMBER WHERE NAME = #{name} AND PHONE = #{phone}
	</select>
	<select id="findpw" resultType="String">
		SELECT COUNT(*) FROM MEMBER WHERE EMAIL=#{email} AND NAME = #{name} AND PHONE = #{phone}
	</select>

	<update id="resetpw">
		UPDATE MEMBER SET PW = #{pw} WHERE EMAIL = #{email}
	</update>
	<select id= "socialIdCheck" resultType="String">
		SELECT COUNT(*) FROM MEMBER WHERE SOCIAL = #{social}
	</select>
	<select id="socialLogin" resultType="kr.co.model.MemberVO">
		SELECT * FROM MEMBER WHERE SOCIAL = #{social}
	</select>
	<select id="partnerCheck" resultType="String">
		SELECT COUNT(*) FROM MEMBER WHERE EMAIL = #{partner_id}
	</select>
	<update id="patientRegister">
		update member SET GUARDIAN_ID = (SELECT MEMBER_ID
										 FROM MEMBER
										 WHERE EMAIL = #{email}) where EMAIL = #{guardian_id}
	</update>

	<update id="modify">
		UPDATE MEMBER SET PW=#{pw} , NAME=#{name},PHONE=#{phone},ADDRESS=#{address} ,ADDRESS_DETAIL=#{address_detail}  WHERE MEMBER_ID=#{member_id}
	</update>
</mapper>